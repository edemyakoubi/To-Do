<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Task Dashboard</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='home.css') }}"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="sidebar">
      <div class="name-container">
        <div class="name" id="userName">John Doe</div>
        <div class="status-circle online"></div>
        <div class="profile-actions">
          <button class="btn btn-danger action-btn" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i>
          </button>
        </div>
      </div>

      <div class="highlights">
        <h3><i class="fas fa-star"></i> Highlights</h3>
        <div class="highlights-cards">
          <!-- Total tasks -->
          <div class="highlights-card">
            <div class="card-icon"><i class="fas fa-list"></i></div>
            <div class="card-content">
              <h3 id="totalTasks">{{ total_tasks }}</h3>
              <p>Total tasks</p>
            </div>
          </div>

          <!-- Completed tasks -->
          <div class="highlights-card">
            <div class="card-icon"><i class="fas fa-check-circle"></i></div>
            <div class="card-content">
              <h3 id="completedTasks">{{ completed_tasks }}</h3>
              <p>Tasks completed</p>
            </div>
          </div>

          <!-- Pending tasks -->
          <div class="highlights-card">
            <div class="card-icon"><i class="fas fa-hourglass-half"></i></div>
            <div class="card-content">
              <h3 id="pendingTasks">{{ pending_tasks }}</h3>
              <p>Tasks pending</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-content">
      <div class="stat-body">
        <div class="stat-grid">
          <div class="stat-card">
            <div class="stat-icon">
              <i class="fas fa-chart-line"></i>
            </div>
            <div class="stat-content">
              <h3>Completion Rate</h3>
              <p id="completionRate">
                {{ completion_rate }}% of tasks completed
              </p>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-icon">
              <i class="fas fa-exclamation-circle"></i>
            </div>
            <div class="stat-content">
              <h3>High Priority</h3>
              <p id="highPriorityCount">{{ high_priority_count }} tasks</p>
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-icon">
              <i class="fas fa-clock"></i>
            </div>
            <div class="stat-content">
              <h3>Latest Task</h3>
              <p id="latestTask">{{ latest_task }}</p>
            </div>
          </div>

          <div class="stat-card progress-card">
            <div class="stat-icon">
              <i class="fas fa-tasks"></i>
            </div>
            <div class="stat-content">
              <h3>Progress</h3>
              <div class="progress-bar">
                <div
                  class="progress"
                  id="progressBar"
                  data-completion="{{ completion_rate | default(0) }}"
                ></div>
              </div>
              <p id="progressText">{{ completion_rate }}% Complete</p>
            </div>
          </div>
        </div>
      </div>

      <section class="tasks-section">
        <h2>Tasks</h2>
        <div class="add-task-container">
          <form
            id="addTaskForm"
            method="POST"
            action="{{ url_for('views.add_task') }}"
            class="add-task-container"
          >
            <input
              type="text"
              name="title"
              placeholder="What would you like to accomplish?"
              class="task-input"
              required
            />

            <select name="priority" class="priority-select">
              <option value="Low">Low Priority</option>
              <option value="Medium" selected>Medium Priority</option>
              <option value="High">High Priority</option>
            </select>

            <button type="submit" class="add-task-btn">
              <i class="fas fa-plus"></i> Add
            </button>
          </form>
        </div>

        <div class="tasks-container">
          <ul class="task-list" id="taskList">
            {% if tasks %} {% for task in tasks %}
            <li
              class="task-item {{ 'completed' if task.completed else '' }}"
              draggable="true"
              data-task-id="{{ task.id }}"
              data-priority="{{ task.priority | lower }}"
            >
              <span
                class="priority-circle priority-{{ task.priority | lower }}"
              ></span>
              <span class="task-title">{{ task.title }}</span>
              <div class="task-actions">
                <form
                  method="POST"
                  action="{{ url_for('views.toggle_task', task_id=task.id) }}"
                  style="display: inline"
                >
                  <button type="submit" class="btn btn-check">âœ”</button>
                </form>

                <form
                  method="POST"
                  action="{{ url_for('views.delete_task', task_id=task.id) }}"
                  style="display: inline"
                >
                  <button type="submit" class="btn btn-giveup">ðŸš«</button>
                </form>
              </div>
            </li>
            {% endfor %} {% else %}
            <li class="empty-state" id="emptyState">
              <i class="fas fa-clipboard-list"></i>
              <p>No tasks yet. Add one above! âœ¨</p>
            </li>
            {% endif %}
          </ul>
        </div>
      </section>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
  </body>
</html>
